---
description: EverQuest Emulator Server code changes for year 2008
---

# 2008

## 12/31/2008

* **Congdar** Bots: Added rule EQOffline:BotManaRegen default 1.0 is fastest. 3.0 is closer to player regen rates
* **Congdar** Bots: Added rule EQOffline:BotFinishBuffing default true. Allows out of combat buffing to complete even if the bot is out of mana.
* **Congdar** Bots: Fixed bug where bot ownership could change to somebody else.
* **Congdar** Bots: Added caster AA's for critical damage

## 12/27/2008

* **Trevius** Changed QueryLoot so that commands that use it \(\#npcstats & \#npcloot show\) will now show Item Links instead of just Item Names.
* **Trevius** Added Item Links to \#peekinv
* **Trevius** Added new console command "LSReconnect" to allow manually restarting the auto Login Server connect loops if they stopped for any reason
* **Trevius** Added a Reconnect option in the Web Tool to allow auto Login Server connect to restart if it has stopped and is not connected already.
* **Derision** New program, mailserver, to implement in-game mail. See: [http://www.eqemulator.net/wiki/wikka.php?wakka=MailServer](http://www.eqemulator.net/wiki/wikka.php?wakka=MailServer),

  ```text
  or mailserver/readme.txt
  ```

Required SQL:

CREATE TABLE `mail` \( `msgid` int\(10\) unsigned NOT NULL auto\_increment, `charid` int\(10\) unsigned NOT NULL, `timestamp` int\(11\) NOT NULL default '0', `from` varchar\(100\) NOT NULL, `subject` varchar\(200\) NOT NULL, `body` text NOT NULL, `to` text NOT NULL, `status` tinyint\(4\) NOT NULL, PRIMARY KEY \(`msgid`\), KEY `charid` \(`charid`\) \) ENGINE=MyISAM DEFAULT CHARSET=utf8;

ALTER TABLE `character_` ADD `mailkey` CHAR\( 16 \) NOT NULL ;

## 12/22/2008

* **Trevius**\(Denivia\) Pets that are on Hold will now follow their master
* **Trevius**\(Denivia\) Pets will no longer try to attack corpses

## 12/20/2008

* **KLS** Removed old unused Guildwars, RaidAddicts and GroupLinking code.

## 12/19/2008

* **KLS** Updated how spawn timers work, spawn timers will now be based off absolute time like regular timers which will allow them to tic down even when the server is offline.
* **KLS** Quest::clearspawntimers\(\) has been disabled for now, will be reactivated in next update on spawn timers.
* **KLS** Likewise \#repop force has been temp. disabled as well pending updated code.

  =Update=

* **KLS** Enabled Quest::clearspawntimers\(\) and \#repop force once again.
* **KLS** Added quest::updatespawntimer\(id, duration\) to update the respawn time of a dead mob, this only applies if the mob is dead and will only apply once: ie. once the mob repops and dies again it will use it's normal respawn time unless this is called again. Not completely tested.
* **KLS** creategroundobject constructor should create objects with max charges now. Untested.

Required SQL: DROP TABLE IF EXISTS `respawn_times`; CREATE TABLE `respawn_times` \( `id` int\(11\) NOT NULL default '0', `start` int\(11\) NOT NULL default '0', `duration` int\(11\) NOT NULL default '0', PRIMARY KEY \(`id`\) \) ENGINE=InnoDB DEFAULT CHARSET=latin1;

ALTER TABLE `spawn2` DROP `timeleft`;

## 12/15/2008

* **KLS** Added 2nd pass to heal aggro to correctly divide aggro between those recieved not just give all recieved full aggro.

## 12/13/2008

* **Derision** Fixed a couple of causes of combat related zone crashes.

## 12/12/2008

* **Derision** Name of the seller now reported correctly in the /buyer window.

## 12/09/2008

* **AndMetal** Added Client::MakeItemLink function, which allows for augments in Item Links. Can be used for Chat & Task windows. See zone/inventory.cpp for detailed notes on usage in the source.
* **AndMetal** Updated quest::itemlink & loot drops to use MakeItemLink.
* **AndMetal** \(trevius\) Fixed a small typo in utils/export\_spells.pl.

## 12/08/2008

* **Trevius** Changed \#itemsearch output to now place itemlinks for all items it outputs from the search
* **Trevius** Increased the max results of \#itemsearch from 20 up to 50
* **Trevius** Added alias \#fi as an abbreviation of \#finditem, to shorten the command
* **Trevius** Changed the default required status for accounts to access item search commands to min status of 10 \(previously 0\)

## 12/01/2008

* **Trevius** Moved mounts \(Horses/Drogmors\) into their own table instead of them being hard coded in the source.

Required SQL: utils/sql/svn/235\_horses\_table.sql

## 11/26/2008

* **cavedude00** Traps will no longer be trackable.

## 11/24/2008

* **AndMetal** Spells can now be loaded from the database, and is now enabled by default. Use utils/import\_spells.pl to import, utils/export\_spells.pl to export. Use -h on either for usage.
* **Trevius** Food and Drink will now actually give stats.

Required SQL: utils/sql/svn/229\_spells\_table.sql

## 11/22/2008

Trevius/ _\*AndMetal_ Corrected the output of \#showstats to provide accurate Attack Rating calculations.

* **Derision** Initialise animation to zero in the Mob constructor to prevent players sometimes appearing to run off when they first spawn.
* **Derision** /buyer /barter fix.
* **Trevius** Added Account Limiting to allow limiting how many characters can be logged in per account at once \* See Optional SQL.

## 11/20/2008

* **Derision** Implemented /buyer \(cash compensation only\) and /barter. Update your patch\_Titanium.conf from the utils directory.

REQUIRED SQL:

DROP TABLE IF EXISTS `buyer`; CREATE TABLE `buyer` \( `charid` int\(11\) NOT NULL, `buyslot` int\(11\) NOT NULL, `itemid` int\(11\) NOT NULL, `itemname` varchar\(65\) NOT NULL, `quantity` int\(11\) NOT NULL, `price` int\(11\) NOT NULL, PRIMARY KEY \(`charid`,`buyslot`\) \) ENGINE=MyISAM DEFAULT CHARSET=utf8;

ALTER TABLE `trader_audit` ADD `trantype` TINYINT NOT NULL DEFAULT '0';

## 11/20/2008

* **cavedude00** \(aza77\) Added quest::collectitems.
* **cavedude00** \(Rocker8956\) Zones with IDs higher than 255 can now be instanced.

## 11/19/2008

* **seveianrex** \(Varkalas\) WAR Sturdiness AA Fix
* **AndMetal** zone-\*.log files on Linux will allow read access to group members. You may need to erase any existing logs to see the change.
* **AndMetal** Added some logging for spell crits \(SPELLS\_\_CRITS\)

## 11/18/2008

* **Derision** Bazaar: Added support for changing prices without ending Trader mode.

## 11/16/2008

* **Derision** Added command 'undyeme' to restore all a player's armor slots to their natural undyed state.
* **Trevius** \(Denivia\) Changed Expansive Mind AA so that it raises the Worn Mana Regen Cap \(as it should\) instead of just increasing mana regen.
* **Derision** Bazaar bug fix relating to items with -1 max charges.

Optional SQL:

INSERT INTO commands \(command, access, description\) VALUES \('undyeme', 0, 'Remove dye from all of your armor slots'\);

## 11/15/2008

* **seveianrex** Implemented AA use of SE\_Accuracy \(Ranger GoD AA "Precision of the Pathfinder" will have an effect now\)
* **seveianrex** Implemented Enchanter GoD AA "Mesmerization Mastery"
* **seveianrex** Adjusted Monk Kick Mastery damage modifiers slightly.
* **Derision** Using Find Trader in the Bazaar will teleport you to the Trader.
* **Derision** Added Rule Bazaar:EnableWarpToTrader, default true.
* **Derision** Added Rule World:TutorialZoneID, default 189 \(tutorialb\).
* **Derision** MinPrice/MaxPrice in the Bazaar search window are now interpreted correctly as values in Platinum.
* **Derision** Bazaar bug fix.

## 11/14/2008

* **seveianrex** Adjusted Coat of Thistles AA modifier.
* **seveianrex** Implemented Pet Crits for NEC/MAG/BST \(Deaths Fury, Elemental Fury, Warders Fury GoD era AAs\)
* **Derision** Bazaar Trader mode \(not Barter\). Please test it well.
* **Derision** Updated OP\_ShopDelItem for Titanium.

REQUIRED SQL:

DROP TABLE IF EXISTS `trader`; CREATE TABLE `trader` \( `char_id` int\(10\) unsigned NOT NULL default '0', `item_id` int\(10\) unsigned NOT NULL default '0', `serialnumber` int\(10\) unsigned NOT NULL default '0', `charges` int\(11\) NOT NULL default '0', `item_cost` int\(10\) unsigned NOT NULL default '0', `slot_id` tinyint\(3\) unsigned NOT NULL default '0', PRIMARY KEY \(`char_id`,`slot_id`\) \) ENGINE=MyISAM DEFAULT CHARSET=utf8;

DROP TABLE IF EXISTS `trader_audit`; CREATE TABLE `trader_audit` \( `time` datetime NOT NULL, `seller` varchar\(64\) NOT NULL, `buyer` varchar\(64\) NOT NULL, `itemname` varchar\(64\) NOT NULL, `quantity` int\(11\) NOT NULL, `totalcost` int\(11\) NOT NULL \) ENGINE=MyISAM DEFAULT CHARSET=utf8;

UPDATE doors set opentype=155 where opentype=154 and zone='bazaar';

## 11/12/2008

* **Congdar** Bots: add command \#bot lore \* Casts Identify on the item on your mouse pointer
* **seveianrex** Tweaked the Slay Undead damage to once again. Damage should be in-line with live numbers now.
* **Angelox** \(Kobaz\): Fix for 'PIC register bx clobbered in asm' error
* **Angelox** Improved filtering on \[bot track rare\] option for Ranger
* **Angelox** Added option \[bot track near\] for Ranger

## 11/11/2008

* **Congdar** Bots: fix ghosting when runnning up to targets

## 11/10/2008

Trevius/ _\*Derision_ Fix for GM Training Point exploit when de-leveling and leveling up again

## 11/10/2008

* **Derision** Implemented Looking For Group/Looking For Players Window. patch\_Titanium\_conf has been updated.
* **Derision** Visual Studio users should add world/lfplist.h and world/lfplist.cpp to their project.

REQUIRED SQL:

ALTER TABLE `character_` ADD `lfp` TINYINT\( 1 \) UNSIGNED NOT NULL DEFAULT '0'; ALTER TABLE `character_` ADD `lfg` TINYINT\( 1 \) UNSIGNED NOT NULL DEFAULT '0';

## 11/08/2008

* **Congdar** Bots: add command \#bot resurrectme
* **Congdar** Bots: modify heal ai, more mana calcs
* **Congdar** Added Rule to allow melee to bind anywhere casters can bind, default is false

  optional sql:

    insert into rule\_values values \(1, 'Character:BindAnywhere', true\);

* **seveianrex** Figured out what was crashing ranged procs. Is fixed and fully implemented now. Rangers rejoice..
* **seveianrex** Modified the way \#melody works to improve the delay between songs being casted. Bards rejoice..

## 11/07/2008

* **seveianrex** GoD Rogue AA's: Seized Opportunity, Triple Backstab implemented
* **seveianrex** \(LeftRoad\) Provide a damage message to client when mob is killed by a spell
* **Congdar** Bots: reduce spam, fix crash when fighting Dain, change mana/hp from npc to client like calcs
* **Congdar** make heading calculation more efficient, change sint8 to float for float calculations and heading variable
* **seveianrex** Added \#melody as a supplement for /melody until the OPcode can be located. Don't forget to:

INSERT INTO commands \(command, access, description\) VALUES \('melody', 0, 'A supplement for /melody until the OP code is found.'\)

* **seveianrex** Added support for defensive and ranged spell-effect based procs. Having some zone-crash issues with the ranged proc code for some reason, so it's commented out until I can fix it.

## 11/05/2008

* **Derision** Dyed armor color should now show up correctly to other players.
* **Derision** Implemented the Potion Belt.

## 11/03/2008

* **seveianrex** Added some scaling to the way NPC hitboxes are calculated. This corrects some of the issues with mobs like Wurms/Dragons who you could hit from miles away.
* **seveianrex** NPCs who are 5% HP or lower, are fleeing, and have a decent snare on will no longer cover so much distance.
* **seveianrex** Implemented Mob::GetSnaredAmount\(\) function, utilized in the above. Returns the ABS\(\) value of the snare.

## 11/01/2008

* **seveianrex** GoD AA Implementations: \[CLR\] Touch of the Divine, \[BRD\] Internal Metronome, \[SHD\] Improved Consumption of the Soul
* **Derision** Allow backtick through the CleanName filter.
* **Derision** Pickpocket should no longer occasionally bug the UI.
* **Derision** Pickpocketing money should no longer show twice the amount taken in the client.
* **Derision** Looting stackable PVPItem now works.
* **Derision** Client now updates correctly when a charge on an item with a right click effect is used. Update your patch\_Titanium.conf

## 10/31/2008

* **seveianrex** Monk updates: Strikethrough AA, Mend Worsen Frequency Tweak, Kick Mastery AA Fix
* **seveianrex** Implemented Pet Flurries for MAG/BST/NEC
* **Derision** Extended quest::popup to take optional PopupID and buttontype \(OK or YES/NO\) fields.

## 10/30/2008

* **KLS** Spell crits should work reasonably well once again.
* **Derision** Fixed inability to jump introduced in Rev161.

## 10/29/2008

* **Derision** Mobs in water should no longer sink to the bottom.
* **cavedude00** Added rule to enable DeathExpLossMultiplier, or to use server code default.

Optional SQL: Insert into rule\_values values \(0, 'Character:UseDeathExpLossMult', 'true'\);

## 10/27/2008

* **seveianrex** Added server-side code for WAR sturdiness AA
* **Angelox** \(Cbodmer\) Experience loss based on cbodmers formula with added rule to regulate loss amount
* **Trevius** \(Denivia\) Added Critical Spell Damage for Lifetaps with the proper AAs

Optional SQL \(options are 0-10, defaults to 3\): Insert into rule\_values values \(0, 'Character:DeathExpLossMultiplier', 3\);

## 10/26/2008

* **Derision** Implemented Bandolier. Test thoroughly before trusting it with your Epic.
* **Derision** Minor change to enable the spell Tiny Companion to work.

## 10/24/2008

* **seveianrex** Implemented various GoD AAs: Coat of Thistles, Rapid Strikes, Elemental Durability, Subtlety2, Strengthened Strike, Vicious Smash
* **seveianrex** Implemented GoD Monk AA "Kick Mastery"
* **Trevius** Adjusted the new Frenzy AAs code to fix a crash
* **Trevius** Removed the Shield Block for Paladin/SK AA until code is revised and working
* **Trevius** \(Denivia\) Added Advanced Theft of Life and Soul Thief for Necros and SKs
* **Trevius** \(Denivia\) Added Death Peace AA
* **Trevius** \(Denivia\) Added Blur of Axes and Vicious Strike AAs for Berserkers
* **Trevius** \(Denivia\) Added Shield Block AA for Paladin/SK
* **Derision** 'Killing' LDoN chest type objects\(e.g. Vermin Nests\) will now update kill activities.
* **KLS** Revert Lag fixes that were causing movement and facing abnormalities.
* **KLS** Fix to a few problems with quest::creategroundobject that was causing it to not work in some situations.

## 10/23/2008

* **Congdar** Clone NoDrop removal code to NoRent, Lore, NoTrade.  Optionally enabled in the db Variables table DisasbleNoDrop=1 DisableNoRent=true DisableLore=1 DisableNoTrade=1
* **Congdar** Bot code cleanup, method call reduction
* **Congdar** Bot DoubleAttack method is more like clients
* **Congdar** Remove AFK leveling with bots
* **Angelox** Added command '\#Bot evac' for Druid bots
* **Angelox** Added command '\#Bot target calm' for Enchanter or Cleric bots
* **Trevius** Removed the \* 10 multiplier from the SE\_ProcChance since it isn't needed
* **KLS** Zone appearance should update for players zoning.
* **KLS** Added command \#modifynpcstat
* **KLS** Added quest::modifynpcstat\(identifier, value\)
* **KLS** Fix potential crash in MobProcess
* **KLS** Added decay option to CreateGroundObject
* **KLS** Added spelltype mez\(2048\) and spelltype in combat buff\(1024\).
* **KLS** Setting level for npcs will now update their spawn level too.
* **KLS** Fix potential memory leak in item link code.
* **KLS** Changed resists a bit.
* **KLS** Added rule: Spells:ResistPerLevelDiff\(85\) 8.5 resist points per level diff
* **KLS** Added rule: Combat:BaseHitChance\(54.0\)
* **KLS** Added rule: Combat:HitPerLevelDiff\(145\) 45% per level diff
* **KLS** Added rule: Combat:AgiHitFactor\(0.015\)
* **Derision** Added 'Repeatable' column to to tasks table. Default 1 \(true\).

Required SQL:

ALTER TABLE `tasks` ADD `repeatable` TINYINT\( 1 \) UNSIGNED NOT NULL DEFAULT '1';

## 10/22/2008

* **AndMetal** Fix for item links to prevent occasional zone crashes
* **AndMetal** Critical DOTs should now work correctly
* **AndMetal** Fixed sql/svn/125\_aggrozone.sql to work with current command table schema
* **AndMetal** \(Theeper\) Shared Bank platinum. Added rule Character:SharedBankPlat\(false\) to enable since it is possible to dupe plat with multiple characters logged in on the same account at the same time
* **AndMetal** Fixed a few random compile warnings
* **Angelox** Bot Tracking improves as levels increase.
* **Angelox** Druid Bot is now next best tracker
* **AndMetal** Support for +Stat Cap \(Wunshi's Focusing, etc\)
* **AndMetal** New rules for tweaking spell crits: Spells:BaseCritChance\(0\), Spells:BaseCritRatio\(0\), Spells:WizCritLevel\(12\), Spells:WizCritChance\(7\), Spells:WizCritRatio\(15\)
* **AndMetal** Loot messages will now have item links instead of just the item name

## 10/21/2008

* **KLS** Some changes to make compiling with profiler enabled more error free.
* **KLS** Added player quest event EVENT\_TASK\_STAGE\_COMPLETE exports $task\_id and $activity\_id.
* **KLS** Added player quest event EVENT\_PICK\_UP exports $picked\_up\_id for when a player picks up a ground spawn or dropped item.
* **KLS** Added quest::CreateGroundObject\(itemid, x, y, z, heading\) which lets the quest script create ground objects in the zone like if they had been dropped.
* **KLS** Objects should decay after they're loaded back into the world. Might want to backup your objects table till I can confirm this works 100%.
* **KLS** Lowered ground object decay time from 30 min to 5 min.

## 10/20/2008

* **AndMetal** \(erde\) Moved SVN SQL updates to utils/sql/svn. File name will start with the revision they were introduced & optional updates have optional somewhere at the beginning of the name
* **Derision/Trevius** Implemented sub EVENT\_AGGRO\_SAY
* **AndMetal** Implemented Reverse Damage Shield
* **AndMetal** Fixed +Damage Shield on items so that it doesn't work without having a Damage Shield spell first
* **AndMetal** \(seveianrex\) Hate w\[h\]iped on CoH
* **AndMetal** \(via Yeahlight\) New command: \#aggrozone. Requires 100 status by default

## 10/19/2008

* **Angelox** Added a start to Bot tracking \* Thanks Derision for all the help and know-how.
* **Derision** Altered damage shield message processing to be more like \(the same?\) as live.
* **Derision** If it exists, damage shield types are read from a new table \(damageshieldtypes\)
* **Derision** If no entry exists in the table, a default based on resist type is used.

Optional SQL: See utils/sql/damageshieldtypes.sql

## 10/18/2008

* **KLS** Reworked classic style traps.
* **KLS** Debuff style traps should function perfectly, the level field in the DB gives what level the caster is for resists in this case.
* **KLS** Added respawn and respawn variance to traps.
* **KLS** Increased range on sense traps.
* **KLS** Sense trap will now point the player in the direction of the trap they are sensing.
* **KLS** Disarm trap will no longer use sense trap's timer.
* **KLS** Disarm trap will no longer fail to disarm traps on success.
* **KLS** Increased range on disarm trap slightly.
* **KLS** Change to MakeRandomInt\(\) and MakeRandomFloat\(\)
* **KLS** Int generation be nearly 100% or more faster in most cases and float generation should be slightly faster in most cases
* **cavedude00** \(seveianrex\) Slay Undead Fix
* **cavedude00** \(seveianrex\) Levitate effect will no longer be removed in cases where you have two stacked lev spells and the first wears off.
* **cavedude00** \(seveianrex\) Hate list will now be cleared following CoH
* **cavedude00** \(seveianrex\) Group members will now see tradeskill emotes.

Required SQL: ALTER TABLE `traps` DROP `spawnchance`; ALTER TABLE `traps` ADD `respawn_time` INT\(11\) UNSIGNED DEFAULT '60' NOT NULL AFTER `skill`; ALTER TABLE `traps` ADD `level` MEDIUMINT\(4\) UNSIGNED DEFAULT '1' NOT NULL AFTER `skill`; ALTER TABLE `traps` ADD `respawn_var` INT\(11\) UNSIGNED DEFAULT '0' NOT NULL AFTER `respawn_time`;

## 10/17/2008

* **KLS** Tweaks to /pet attack
* **KLS** Renamed WhipeHateList to WipeHateList so I never have to view that spelling monster ever again.
* **cavedude00** \(Rocker8956\) Added shutdowndelay to zone query.

## 10/16/2008

* **Derision** Cosmetic change to foraging to correctly identify food/drink items.
* **cavedude00** Added rules to determine if /ooc and /auction should be server wide \(true\) or zone wide \(false \* Live Like\).
* **cavedude00** \#peqzone can no longer be used if invulnerable.
* **KLS** More changes to proc code.  Added an option of calc. proc rate based on speed of the weapon
* **KLS** Added Rules: Combat:AdjustProcPerMinute\(true\), Combat:AvgProcsPerMinute\(18.0\), Combat:ProcPerMinDexContrib\(0.075\), Combat:BaseProcChance\(0.035\), Combat:ProcDexDivideBy\(11000\)
* **KLS** Tweak to monster AI to hopefully save computation.

Optional SQL: insert into rule\_values values \(0, 'Chat:ServerWideOOC', 'true'\); insert into rule\_values values \(0, 'Chat:ServerWideAuction', 'true'\);

## 10/15/2008

* **Derision** Added OP\_LevelAppearance to utils/patch\_Titanium.conf and it is now sent to nearby clients \(eye candy when you level\)
* **Derision** \(seveianrex\) Alcohol Drinking / Skillup Fix
* **KLS** Change to proc code to correct some oddities with % chance to proc.
* **KLS** Changed how avoidance bonuses are calculated to be like other melee bonuses.
* **KLS** \(seveianrex\) Basic Pet Focus Implementation.

## 10/14/2008

* **Trevius** Charm Spells set to max level of 0 now have unlimited max level as they should
* **Derision** Player pets should no longer be fearable if npcspecialattks contains 'D'.
* **cavedude00** \(Rocker8956\) Changes to quest::getlevel and quest::setinstflag/setinstflagmanually to reduce DB access
* **cavedude00** \(Rocker8956\) Added quest::getinstflag
* **KLS** Fixed crash in shutdown delay, please test things for crashes before adding them, this was pretty obvious.
* **Derision** Removed requirement to be grouped for Translocate spells.

## 10/13/2008

* **Derision** Looting your corpse while liched/wolf form etc should now auto-equip items

## 10/12/2008

* **Derision** No more binding wounds while feigning death.
* **Derision** \(Rocker8956\) Movegrp quest command fix.
* **Derision** \(LeftRoad\) TEMPORARY\(NORENT\) items in a character inventory will be retained if you log back into that character within 30 minutes.
* **KLS** Implemented Raid::TeleportGroup\(\) and Raid::TeleportRaid\(\), untested but should work.
* **KLS** \(seveianrex\) Critical DoT and Sinister Strikes AA.

## 10/11/2008

* **Derision** Resurrection fix.
* **KLS** Rebalanced skill ups.

## 10/10/2008

* **AndMetal** Added functions to calculate AA bonuses just like item & spell bonuses \(not turned on yet\)
* **Condgar** Fix for Bots wont Attack
* **Congdar** Fix low level bots hitting too hard
* **Derision** Prevent two instances of possible zone crashes due to null pointers.
* **Trevius** \(Striat\) Added quest commands for zone and world emotes \* quest::ze\(\) & quest::we\(\)
* **Derision** Recalculate Pet bonuses on zoning before setting current HP/Mana.

## 10/09/2008

* **Congdar** Replace Client IsEngaged\(\) checks in Bot Source with bot aggro check
* **Trevius** \(AndMetal\) Added quest Object SetOOCRegen\(\) to adjust NPC Out of Combat Regen on the fly.
* **Trevius** Relocated the Empty Corpse check code so that the Decay Time rule for it will now work.
* **Trevius** Removed the Level 70 cap on the \#traindisc  command.
* **Trevius** Added optional rule to allow Max Level Attainable via experience to be set independant of other Max Level rule checks.
* **Derision** Reworked code to stop mobs fleeing if they have buddies to account for recent hate\_list changes.

Optional SQL: Insert into rule\_values values \(0, 'Character:MaxExpLevel', 0\);

## 10/08/2008

* **Congdar** Fix orphaned bots when camping/zoning
* **Congdar** Link bot assist with client auto attack
* **Derision** Added \#titlesuffix command to add a title after a player's name.

## 10/07/2008

* **Congdar** Allow bot pets to be the main tank in a bot raid
* **Congdar** Remove old Sense Heading skill check
* **AndMetal** Web interface will now list open petitions.
* **Derision** \#title should now prefix the target player's name, e.g. \#title Lord\_Protector \(underscores are replaced with spaces, max 31 chars\)

## 10/06/2008

* **Angelox** Fix Bot names in group window \(now is 'Mybot' instead of 'Mybot000'\)
* **cavedude00** \(erde\) Fix for world and zone crashing when compiled on VS 2008 in release mode.
* **cavedude00** \(Rocker8956\) Zone shutdown timer rule.
* **cavedude00** Added cleanipc to makefile.

Required SQL: ALTER TABLE `zone` ADD column `shutdowndelay` bigint \(16\) unsigned NOT NULL default '5000'; INSERT INTO rule\_values VALUES \(1,'Zone:AutoShutdownDelay', 5000\);

## 10/04/2008

* **Congdar** Double Attack redo, tested working
* **Congdar** Fix Bot follow bug when a bot gets killed
* **Derision** Added minlevel and maxlevel fields to tasks table and new quest function istaskappropriate\(task\).
* **Derision** All tasks in a TaskSet with a taskid of 0 as one of it's entries are now available to a player, subject to level restrictions.
* **Derision** \(Spoon/Andmetal\) Rez spells with effectdescnum != 82 or 39067 \(6.2 spells\_us\) will give 100% Mana/HP restoration and no rez effects.
* **Derision** Corrected message when interrupting a spell with Shift-S.
* **Derision** Fix to display Frogloks correctly in /who all and /who all froglok \(half of the change came from a post by Theeper on the forums\).

Required SQL: ALTER TABLE `tasks` ADD `minlevel` TINYINT UNSIGNED NOT NULL DEFAULT '0', ADD `maxlevel` TINYINT UNSIGNED NOT NULL DEFAULT '0';

## 10/03/2008

* **Congdar** Add EQOffline Bot Source
* **Derision** Removed 'stepped' column from task table. See [http://eqemulator.net/forums/showthread.php?p=157613](http://eqemulator.net/forums/showthread.php?p=157613)
* **Derision** Added display of Task Description to \#task show to aid in debugging a reported problem.
* **Derision** Lowered default required status for \#task command from 250 to 150 for debugging purposes.
* **KLS** Removed some lingering printf from the raid stuff.
* **KLS** Auto attack code changed to not use target, instead we save the first target and now always use that.
* **KLS** Hate list will no longer work for non ai controlloed player characters.
* **KLS** Fix to crash in monk special attack function.

Required SQL: ALTER TABLE `tasks` DROP `stepped` ;

## 10/02/2008

* **KLS** \(Congdar\) Update to Tech. of Master Wu AA.
* **KLS** Revert of double attack change, people reporting non warriors were no longer double attacking properly.
* **KLS** Compile Warning in Database::GetZoneName\(\)
* **KLS** Change to IsPlayerIllusionSpell\(\) to make it more consistant, illusion spells can be more than 49 so we work off behavior and effect now.
* **KLS** Added AA\_\_Message logs to project illusion code to try to track down an error.

## 10/01/2008

* **Derision** \(erde\) VS2008 Compile Fix \(\#if \(\_MSC\_VER &lt; 1500\) \#define vsnprintf \_vsnprintf \#endif
* **Derision** Fix to stop zone crashing when looting PVPItem and PVPReward is set to 3.
* **cavedude00** Group members will no longer recieve a split when a player corpse is looted.

## 9/30/2008

* **Derision** Task activities with an activitytype of &lt;= 0 in the activities table will be sent with an activitytype of 9 to the client.
* **Derision** The reward field in the task table will now be displayed even if rewardid=0
* **cavedude00** \(Rocker8956\) Added quest function to get average group/raid level.
* **cavedude00** \(Rocker8956\) Changes to setinstflagmanually to allow deletion of instance flags and to allow manual flagging of raids, groups, and individuals.

## 9/29/2008

* **cavedude00** Added rule World:ClearTempMerchantlist to control whether world clears temp merchant items when started or not.
* **AndMetal** \(Congdar\) New Double Attack logic
* **Angelox** Keyring code fix, so clicky portals that require keys will work too.
* **AndMetal** Added AAs: Discordant Defiance, Blacksmithing Mastery, Baking Mastery, Brewing Mastery, Fletching Mastery, Pottery Mastery, Tailoring Mastery, Packrat, Expansive Mind, Veteran's Wrath, Advanced Fury of Magic Mastery, Destructive Fury
* **AndMetal** Ayonae's Tutelage should now calculate bonus for Singing

Optional SQL: insert into rule\_values values \(0,'World:ClearTempMerchantlist','true'\);

## 9/28/2008

* **AndMetal** Fixed exploit for pets ignoring Fear by using /pet commands
* **AndMetal** \#wp add will now use the highest value in the grid\_entries table + 1 if you don't use a Waypoint \# or use 0

## 09/26/2008

* **cavedude00** \(AndMetal\) Deathblow AA
* **cavedude00** \(AndMetal\) Swift Journey AA
* **cavedude00** \(AndMetal\) Convalescence and Healthy Aura AAs
* **cavedude00** \(AndMetal\) Slippery Attacks AA
* **cavedude00** \(trevius/Derision\) Additional IP limiting rules
* **cavedude00** \(Congdar\) Further PC main and second hand attack fixes
* **cavedude00** \(Derision\) Fix for percent heals
* **cavedude00** \(Theeper\) Fix for quest:itemlink\(\)
* **cavedude00** \(Rocker8956\) More work on zone instancing

Optional SQL: Insert into rule\_values values \(0, 'World:AddMaxClientsPerIP', -1 \); Insert into rule\_values values \(0, 'World:AddMaxClientsStatus', -1 \);

## 09/25/2008

* **cavedude00** \(trevius\) IP Limiting Minor Fix
* **cavedude00** \(trevius\) New Quest Command quest::clearspawntimers\(\)
* **cavedude00** \(trevius\) New Quest Command quest::traindiscs\(\)
* **cavedude00** \(trevius\) Enraged, Flurry and Rampage Spamming Fix
* **cavedude00** \(seveianrex\) Implemented Project Illusion AA
* **cavedude00** \(seveianrex\) Corrected AA ding message
* **cavedude00** \(Congdar\) PC main and second hand attack fixes
* **cavedude00** \(Cantus\) 2H weapon damage bonus
* **cavedude00** \(Derision\) /who all friend
* **cavedude00** \(Derision\) All merchants will now show player sold items correctly
* **cavedude00** \(Derision\) Enter tutorial and Return Home buttons during char creation/select
* **cavedude00** \(Derision\) Implemented Task system
* **cavedude00** \(Derision\) Implemented Translocate and Sacrifice Confirmation Boxes
* **cavedude00** \(Derision\) Client popup window
* **cavedude00** \(James76\) Implemented keyring
* **cavedude00** \(AndMetal\) Corrected Technique of Master Wu AA
* **cavedude00** \(AndMetal\) Corrected some proc spells not working after zoning
* **cavedude00** \(Hugghiebear\) Charm will now fade if invis is cast
* **cavedude00** \(AiliaMorisato\) New command \#advnpcspawn and related functions
* **cavedude00** \(Rocker8956\) Preliminary zone instancing
* **cavedude00** \(KLS\) Implemented raid system
* **cavedude00** Fixed autosplit \(Thanks WildcardX!\)
* **cavedude00** New command \#peqzone
* **cavedude00** Several minor forage/fishing fixes

Required SQL is in utils/sql/09252008.sql Make sure you update your .conf files, also found in utils!

## 09/01/2008

* **KLS** \(derision\) Crash Fix.
* **KLS** \(haecz\) Non-Melee damage filter.
* **KLS** \(LordKahel\) Lore Slotted Augment.
* **KLS** \(Spider 661 via trevius\) Chaotic Potential AA
* **KLS** \(Derision\) OP\_Sound update for titanium.
* **KLS** \(ndnet via trevius\) MQ Illegal Item Equip Detection
* **KLS** Modified faction modifiers for buying/selling.
* **KLS** \(AndMetal\) Spell blocking implementation
* **KLS** \(Derision\) Resurrection confirmation
* **KLS** \(Cripp\) Delete stale corpse backup typos
* **KLS** \(AndMetal\) CHA stacking buff bug resolved.

Required SQL: CREATE TABLE `blocked_spells` \( `id` int\(11\) NOT NULL auto\_increment, `spellid` mediumint\(8\) unsigned NOT NULL default '0', `type` tinyint\(4\) NOT NULL default '0', `zoneid` int\(4\) NOT NULL default '0', `x` float NOT NULL default '0', `y` float NOT NULL default '0', `z` float NOT NULL default '0', `x_diff` float NOT NULL default '0', `y_diff` float NOT NULL default '0', `z_diff` float NOT NULL default '0', `message` varchar\(255\) NOT NULL default 'You cannot cast that spell here', `description` varchar\(255\) default NULL, PRIMARY KEY \(`id`\) \)

## 08/15/2008

* **KLS** Fix for groups clearing on new group create.
* **KLS** Fix for null row access in Database::GetLeaderName\(\)
* **KLS** CountDispellableBuffs now will validate buffs spells.

## 08/14/2008

* **KLS** Very basic work on raids.
* **KLS** Moved group id calls to their own database as to not be blocked by long character\_ selects and such.

Required SQL \(Your groups will break completely without this\): CREATE TABLE `group_id` \( `groupid` int\(4\) NOT NULL, `charid` int\(4\) NOT NULL, `name` varchar\(64\) NOT NULL, PRIMARY KEY \(`groupid`, `charid`\) \) ENGINE = InnoDB;

## 08/13/2008

* **KLS** Added dispel field for npc spells as 512.
* **KLS** NPCs should be smarter about when they choose to cast certain spells; namely dots, lifetaps and dispels.
* **KLS** NPCs should continue to cast nuke spells for a longer period of time.
* **KLS** NPCs will no longer have a 2-3 sec forced delay between spell casts; it is now whatever the recovery time of the spell is just like players, beware.
* **KLS** \(trevius\) Change to npcAI recast delay cap 1000-&gt;10000 seconds.
* **KLS** Increased amount of mana npcs gain from int and wis.
* **KLS** New rule: NPC:CorpseUnlockTimer \(150000\) 2.5 min default on corpses being unlocked after loot instead of decay time / 2
* **KLS** New rule: NPC:EmptyNPCCorpseDecayTimeMS \(0\) empty npc corpses will decay after this long + 1000MS on the ground.
* **KLS** More changes to groups: text should now be correct in _almost_ all situations.
* **KLS** Groups should stay synced in almost all situations and leader disbanding should be smoother.
* **KLS** Groups will clear their info on the aquisition of a reused id.
* **KLS** .conf file from earlier /rewind change should be correct now make sure to update it if you want it to function.

Optional SQL: UPDATE npc\_spells\_entries SET type='512' WHERE spellid='48'; UPDATE npc\_spells\_entries SET type='512' WHERE spellid='49'; UPDATE npc\_spells\_entries SET type='512' WHERE spellid='1526'; UPDATE npc\_spells\_entries SET type='512' WHERE spellid='1697';

## 08/11/2008

* **KLS** Group leader info should transfer to a new zone when the leader transfers to that zone.
* **KLS** Will now force a group update to players not in zone, text not correct.
* **KLS** Added \#refreshgroup command \* will refresh group visually from DB
* **KLS** Deleting stale corpses will now bury corpses instead of make them decay if shadowrest is enabled.
* **KLS** Small change to temp merchant lists with regards to charges.
* **KLS** Initial implementation of Technique of Master Wu
* **KLS** Spell's fizzles will now base their mana cost on the correct amount.
* **KLS** Tweak to spell casting expertise and mastery of the past
* **KLS** Hopefully fix to AEUndead spells hitting more than undead

Required SQL \(Your groups will probably break completely without this\): CREATE TABLE `group_leaders` \( `gid` int\(4\) NOT NULL, `leadername` varchar\(64\) NOT NULL, PRIMARY KEY \(`gid`\) \) ENGINE = InnoDB;

## 08/09/2008

* **KLS** Minor tweaks to heal aggro.

## 08/07/2008

* **KLS** Bald char fix revert, will try something else.
* **KLS** Wake The Dead initial implementation.
* **KLS** Hopefully better bald character fix base on kraeger's findings.

## 08/04/2008

* **KLS** \(Derision\) Pet Buff Window Implemented.
* **KLS** Charmed pets should now function with the pet window, as well as appear correctly in group.
* **KLS** Added rule Character:SkillUpModifier \(100\) to govern how fasts skill ups happen on a server.  100% = normal chance, 200% = double normal chance.
* **KLS** \(Derision\) Implemented quest journal npc say.
* **KLS** \(Derision\) Fix for npc not always facing attacker.
* **KLS** \(Derision\) Stop Pets Fleeing
* **KLS** \(CodeMephit\) Hunger and thirst for new characters.
* **KLS** Upped food/water eat/drink gains by a lot.
* **KLS** \(greggg230\) Aggro LOS fix.
* **KLS** Fix for bald characters hopefully.
* **KLS** \(kraeger\) RNG name fix.
* **KLS** Big bug fixes with healing aggro.
* **KLS** Charm spells will stop making a cha check after a certain resist adj threshold
* **KLS** Adjusted melee hit chances to be more forgiving.
* **KLS** Changed how +hit mods are applied
* **KLS** Roughly implemented Skill Attack spell effect.

Required: patch\_6.2.conf and patch\_Titanium.conf files have changed be sure to update them.

## 07/21/2008

* **KLS** \(irv0\) Fix for out of order ack not being sent in some situations.
* **KLS** \(Derision\) Pet bar OOC update fix.
* **KLS** Should have made client pets unable to give experience, untested but should work.
* **KLS** Healing aggro should function better for people not on the hate list.
* **KLS** Some work on public tradeskill objects saving their content between uses.

## 06/22/2008

* **KLS** Changed world/clientlist.cpp's line endings back to unix style line endings
* **KLS** Fixed up ipban based on updated code from TheLieka.

## 06/21/2008

* **KLS** Belated updates to azone including \(derision\)EQG fixes and some changes to make it easier to compile under windows.
* **KLS** Fixed inconsistant line endings in ruletypes.h; there are probably more line ending changes I didn't catch, please try to keep your line endings consistant with what's in the repo.

## 06/19/2008

Scorpious2k \(Knightly\): Correction of divine intervention text Scorpious2k \(LordKahel\): Support for defensive Instinct and Reflexive Mastery AA

## 06/18/2008

Scorpious2k \(Derision\): Fix for flee runspeed \* linear flee speed reduction as HP drops Scorpious2k \(Derision\): Rule to prevent mobs from fleeing if they are being helped by other NPCs Scorpious2k \(haecz\): Distance check for corpse dragging Scorpious2k \(haecz\): Distance check for taunt Scorpious2k \(greggg230\): Merchant price faction/charisma fix Scorpious2k \(greggg230\): Faction will now show on /con for agnostic players Scorpious2k \(BatCountry\): Correction of a zone crash caused by reloading rules Scorpious2k \(Congdar\): Eliminated array index error/zone crash in spells

## 06/17/2008

Scorpious2k \(TheLieka\): Ban by IP Scorpious2k \(cavedude/TheLieka\): Ability to limit melee guys from being bound in certain zones. This changes the canbind column of the zone table. Value 0 means noone can bind, value 1 means only casters can bind, value 2 means anyone can bind in the zone \(ie cities\).

Required SQL: CREATE TABLE `Banned_IPs` \( `ip_address` VARCHAR\(32\) NOT NULL, PRIMARY KEY \(`ip_address`\) \) ENGINE = InnoDB;

Optional SQL: Insert into rule\_values values \(0, 'World:UseBannedIPsTable', 0\); Update zone set canbind = 2 where zoneidnumber in \(1,2,3,8,9,10,19,23,24,29,40,41,42,45,49,52,54,55,60,61,62,67,75,82,83,106,155\);

## 06/14/2008

Scorpious2k\(Trevius\): Door names can now go beyond the 16 char limit to allow doors and other objects from later expansions to be used. The new max is 32 characters. Scorpious2k\(Derision\): New fear adjustment to cause mobs to flee at the correct rates instead of running very fast at certain percentages of health. Scorpious2k\(TheLieka\): Limit the number of connections for an IP address There are 2 new rule values. World:MaxClientsPerIP = Maximum number of simultaneous EQ Client connections allowed per IP address. Set the rule value to -1 to disable this feature. World:ExemptMaxClientsStatus = Minimum Account status to exempt the MaxClientsPerIP rule. This is helpful for the inevitable random family of 16 that live together, and all want to play on your server, as well as GMs, Devs, and QA staff. Again, set the rule value to -1 to disable this feature. Scorpious2k\(TheLieka\): Added /rewind command Scorpious2k\(Striat\): Quest Commands for Temp Race, Texture, Size and Gender Changes

Required sql: ALTER TABLE `doors` MODIFY COLUMN `name` VARCHAR\(32\) CHARACTER SET latin1 COLLATE latin1\_swedish\_ci NOT NULL;

## 05/30/2008

* **Scorpious2k** \(Derision/Wiz\) Added code to implement fear.
* **KLS** \(Leika\) Implemented detection of various MQ activities.
* **KLS** EVENT\_CAST\_ON should now export $spell\_id properly.
* **KLS** Further expanded on fear implementation including addition of rules to govern it's behavior.
* **KLS** Fear on clients still uses stun but the stun should match up with the buff duration in a more accurate manner.

Hackers SQL table: DROP TABLE IF EXISTS `hackers`; CREATE TABLE `hackers` \( `id` int\(4\) NOT NULL auto\_increment, `account` text NOT NULL, `name` text NOT NULL, `hacked` text NOT NULL, `zone` text, `date` timestamp NOT NULL default CURRENT\_TIMESTAMP on update CURRENT\_TIMESTAMP, PRIMARY KEY \(`id`\) \) AUTO\_INCREMENT=8;

## 04/26/2008

* **KLS** Should have fixed discipline and combat ability timer overlap.
* **KLS** Added a rule for partial hits on fear, seperate from normal resist partial hits.
* **KLS** Fixed some quirks in the aggro system.
* **KLS** \(Bulle\)Added quest event EVENT\_KILLED\_MERIT will trigger if you got credit for doing the most damage to a lootable npc.
* **KLS** \(Bulle\)Added quest event EVENT\_CAST\_ON will trigger if a player casts on a npc.
* **KLS** Fixed crash in server-side check for removing detrimental effects.
* **KLS** \(Magoth78\), \(Angelox\)Added zone checks for levitating and being outdoors.
* **KLS** \(haecz\) Fix to dupe corpse money on a zone crash.
* **KLS** Changed root to resist per tic instead of partial hit.

Required SQL: alter table `zone` add column `canlevitate` tinyint \(4\) DEFAULT '1' NOT NULL after `cancombat` alter table `zone` add column `castoutdoor` tinyint \(4\) DEFAULT '1' NOT NULL after `canlevitate`;

## 04/22/2008

* **Rogean** Server-side check for removing detrimental spells.

## 04/13/2008

* **Rogean** Fixed a hack to sell no-drop items to merchants. \(Reported by KingMort\)
* **Rogean** Fixed \#hideme, it won't show you zone in and then disappear anymore. \(Reported by KingMort\)
* **Rogean** Fixed /summon.
* **Rogean** Changes to /who all and GM's:
  * GM \* Tags will no longer show up unless your \#gm on

    You will not show up to players of lower status if your /anon and \#gm on, if your \#gm off and /anon you will show up as

    a normal player, regardless of statuses.

## 04/09/2008

* **KLS** \(AiliaMorisato\)Fixed death packet bindzoneid and attack\_skill fields being switched.
* **KLS** Added rule based caps for all PoP item abilities.
* **KLS** Agility will now affect a defenders chance to be missed slightly.
* **KLS** Added accuracy rating \(10 AR. = 1% chance to hit\) and \(LordKahel\)ATK to npcs.
* **KLS** Changed how mitigation is calculated slightly.
* **KLS** Enc animations will now respond to /pet get lost no matter what level of the animation empathy aa they have.
* **KLS** Hopefully fixed soul abrasion and consumption of the soul aas... again.
* **KLS** Added quest::forcedooropen\(doorid\), quest::forcedoorclose\(doorid\), and quest::isdooropen\(doorid\).
* **KLS** Changed archery calculations to be more similar to normal weapon damage calculations.
* **KLS** Taunt will now always add hate if the user is already on the top of the hate list.
* **KLS** Fixed EVENT\_ZONE player event.

Character:ItemDamageShieldCap \(30\) Character:ItemAccuracyCap \(150\) Character:ItemAvoidanceCap \(100\) Character:ItemCombatEffectsCap \(100\) Character:ItemShieldingCap \(35\) Character:ItemSpellShieldingCap \(35\) Character:ItemDoTShieldingCap \(35\) Character:ItemStunResistCap \(35\) Character:ItemStrikethroughCap \(35\)

Required SQL: ALTER TABLE npc\_types ADD ATK MEDIUMINT NOT NULL DEFAULT '0'; ALTER TABLE npc\_types ADD Accuracy MEDIUMINT NOT NULL DEFAULT '0';

## 04/01/2008

* **Rogean** Fixed a merchant purchase packet exploit.

## 02/28/2008

* **WildcardX** Tweaked the code for the Divine Intervention spell line code and the Unfailing Divinity AA ability.

## 02/27/2008

* **WildcardX** Implemented HeadShot AA Ability.
* **WildcardX** Archery and throwing attacks will not cause you to suffer injury from your target's damage shield.
* **WildcardX** Implemented Spell: Death Pact.
* **WildcardX** Implemented Spell: Divine Intervention.
* **WildcardX** Implemented Unfailing Divinity AA Ability.

## 02/25/2008

* **WildcardX** Enchanters can now control their pets if they purchased the Animation Empathy AA.
* **WildcardX** Mobs now have a chance to resist fear spell line each tic.
* **WildcardX** Mobs now have a chance to resist charm spell line each tic.
* **WildcardX** Implemented Total Domination AA.
* **WildcardX** Reworked new charisma test. This test now evaluates factors like MR, CHA, mob and caster levels. It yields better live-like results.
* **WildcardX** Enchanter pets now get the /pet report and /pet health commands by default.

## 02/23/2008

* **WildcardX** Only characters with Pet Affinity AA can have group buffs casted on their pets.
* **WildcardX** Fixed a bug that would not allow a rune buff to be used in some situations.

## 02/22/2008

* **WildcardX** Characters can now have only one caster specialization skill above 50. If more than one specialization skill is detected above 50, then all specialization skills are reset to 1.
* **WildcardX** Reworked mana reduction calculations.
* **WildcardX** Implemented spell casting specilization checks.

## 02/21/2008

* **WildcardX** Removed the possible fix for the Call of Hero spell as it didnt actually fix the issue after extensive testing.
* **WildcardX** Added new command \#scribespell. This will scribe a specified spell into the target's spell book.
* **WildcardX** Added new command \#unscribespell. This will unscribe a specified spell from the target's spell book.

## 02/20/2008

* **KLS** Zone crash fix caused by calling the TryWeaponProc\(\) method when dead.
* **WildcardX** Changed the quest function depopzone\(\) to accept a parameter to specify if the spawn timers should resume or become disabled. 0 = Disable, 1 = Enable.
* **WildcardX** Added the quest function repopzone\(\). This function will cause a zone to repop it's spawns normally.
* **WildcardX** Possible fix for a zoning bug caused by the Call Of Hero spell.
* **WildcardX** Harmony/Pacify line of spells will now cause aggro when resisted.
* **WildcardX** Added a check against CHA to avoid aggro from a resisted Harmony/Pacify spell.

## 02/19/2008

* **WildcardX** Found a small efficiency for the code that determines if an item is equipable.
* **WildcardX** Re-worked the rune spell buff code to make it more efficient and reduce CPU utilization.
* **WildcardX** Added the quest function depopall\(int npctype\_id\). This will remove all mobs from the zone with the specified npctype\_id.
* **WildcardX** Added the quest function depopzone\(\). This will remove all mobs from the zone and NOT cause a repop.

## 02/10/2008

* **WildcardX** Mesmerize line of spells will now cause aggro when casted on a mesmerize immune mob.
* **WildcardX** Fixed enchanter spell Theft of Thought. This spell will now work as described.
* **WildcardX** The pacify/harmony line of spells will no longer require a line of sight check to complete a cast.

## 01/28/2008

* **WildcardX** Regenerated perl\_mob.cpp due to deprecating the following methods: GetFamiliar\(\), SetFamiliar\(\), GetRune\(\), SetRune\(\), GetMagicRune\(\), SetMagicRune\(\).
* **WildcardX** Enchanters, this is your patch! Characters will now benefit from all rune and spell rune spell effects all spell buffs will provide, consistent with spell rules.
* **WildcardX** Rune and spell rune spell buffs will now persist zoning and camping.
* **WildcardX** Fixed a zone crash caused by TryWeaponProc\(\) method.

## 01/27/2008

* **WildcardX** Subtle changes to zoning code to allow both the 6.2 and Titanium client to perform all zoning operations similiar to live.
* **WildcardX** Fixed \#zone and \#goto commands for both the 6.2 and Titanium client.

## 01/25/2008

* **WildcardX** Regenerated perl\_client.cpp and perl\_groups.cpp due to parameter changes for Group::TeleportGroup and Client::MovePC methods. Changes to some quest files may be necessary.
* **WildcardX** void    MovePC\(int32 zoneID, float x, float y, float z, float heading\)
* **WildcardX** void    TeleportGroup\(Mob\* sender, int32 zoneID, float x, float y, float z, float heading\)
* **WildcardX** Pets will now report their buff list along with their health.
* **WildcardX** Fixed a bug that resulted in a zone crash if spell error logging is turned on.
* **WildcardX** \(cavedude\) Corrected an item id and some small typos in fishing.
* **KLS** Fixed a potential crash in Mob::CheckWillAggro\(\)
* **KLS** Tweaked melee accuracy.
* **KLS** Ironed out some quirks between min hit and the AC code that was keeping it from mitigating some hits into misses.
* **KLS** \(Knightly\)\#time should no longer be off by an hour, $zonehour, $zonemin and $zonetime are now exported to perl
* **KLS** Added player quests, player quests are quests designed to be attached to player processes such as zoning and clicking objects.
* **KLS** Player quests are loaded as either 'quests/zonename/player.pl' or as a template in 'quests/template/player.pl'
* **KLS** Player quests will export qglobals the client should be able to see and the following events are available for player quests:

  EVENT\_TIMER with var $timer

  EVENT\_CLICKDOOR with var $doorid

  EVENT\_LOOT with vars $looted\_id and $looted\_charges

  EVENT\_ZONE with var $target\_zone\_id

  EVENT\_ENTERZONE with no special var

  EVENT\_LEVEL\_UP with no special var

## 01/24/2008

* **WildcardX** Removed a 64 character cap length on merchant names sent during a merchant greeting.
* **WildcardX** Fixed a bug that allowed players looting their corpse at just the right time, to duplicate their items.
* **WildcardX** Fixed a bug I caused in group portals when I corrected the Succor/Evac line.
* **WildcardX** Druids and Wizards rejoice! Succor/Evac will now perform a real zone and clear your aggro!
* **WildcardX** GM's can now summon players from one zone to another.
* **WildcardX** Cleaned up some of the code that handles zoning.
* **WildcardX** \(cavedude\) Reworked LeaveCorpses and LeaveNakedCorpses rules to allow for more options.
* **WildcardX** \(cavedude\) Created Character:DeathItemLossLevel rule to define when a player will leave items on a corpse.

Required SQL: insert into rule\_values values\(0, 'Character:DeathItemLossLevel', 10\);

## 01/22/2008

* **KLS** Clients will be immune to proximity aggro until they are finished loading now.
* **KLS** Slightly reduced the melee accuracy of clients.
* **KLS** Melee mitigation should now properly enforce minimum damage.
* **KLS** Increased the level based damage bonus for high level characters in melee combat.
* **KLS** Removed tic by tic healing aggro.
* **KLS** Fixed several potential crashes in various parts of the code.
* **KLS** \(Knightly\)Merchants will now use their clean names when conversing with players.
* **KLS** Fixed some improper casting in the GMSummon code.
* **KLS** Figured in a work around for corpses between the server and client becoming unsynced for /corpse
* **KLS** AA Consumption of the soul should now function correctly.
* **KLS** AA Soul Abrasion should now function correctly

## 01/19/2008

* **KLS** Slightly reduced the effectivness of the Flurry AA
* **KLS** Speed of the Knight AA implemented
* **KLS** Evade will now reduce hate by a static amount, the static amount of hate increased slightly.
* **KLS** Healing aggro should now not aggro pets instead of their owners,
* **KLS** Removed the clause that made it so healing aggro was only effective if the healer had 100 hate or more on the target, effectivly making healers below level 30 immune to healer aggro.
* **KLS** HideReuseTime on the server reduced by 1 second, should reduce the number of times a player sees the 'Reuse time not met' error message.
* **KLS** Pets should now default to taunt ON instead of taunt OFF
* **KLS** Fixed a typo in ZoneDatabase::UpdateSpawn2TimeLeft\(\)
* **KLS** LDoN treasure should now really check only class and not body type.
* **KLS** Added new rule NPC:BuffFriends, if false npcs will only heal and not buff their friends, defaults to false.
* **KLS** Changed Mob::CheckHitChance\(\) should be more consistant throughout the levels; puts more value into skill levels.
* **KLS** Changed Mob:AvoidDamage\(\) to use a single roll system, as well as applied dex to parry, block and riposte chance and agil to dodge.
* **KLS** Brought the melee attack formula more in line with what it should be.
* **KLS** Added a moderate melee damage bonus to monks, and a small one to all classes at 50, 55 and 60.
* **KLS** Fixed an issue with strikethrough where it could go off even if you had no chance to strikethrough.
* **KLS** NPCs will now load their skills from the max skills of their level via the skill caps database instead of being randomly generated.
* **KLS** Increased the damage of backstab from str and dex and the general damage of several monk abilities.
* **KLS** Mob::GetProcID\(\) should now try to fix SK spells automatically.
* **KLS** Aggro changes: Aggro has been changed to be based on a more live-like system, it is now based on potential damage instead of actual inflicted damage, hate is now unaffected by melee mitigation and resists.
* **KLS** Implemented jolt like effects straight into the aggro system, such effects should be calculated into a spells aggro regardless of resistance now.
* **KLS** Added an optional smart aggro list controlled by rule Aggro:SmartAggroList; true will enable it.  This aggro list attempts to choose targets in a much smarter fashion, prefering players to pets, sitting and critically injured players to normal players, and players in melee range to players not.

Added several rules to adjust the aggro system with: Aggro:SmartAggroList \( true \) Aggro:SittingAggroMod \( 35 \) Aggro:MeleeRangeAggroMod \( 20 \) Aggro:CurrentTargetAggroMod \( 0 \) Aggro:CriticallyWoundedAggroMod \( 100 \) Aggro:SlowAggroMod \( 450 \) Aggro:IncapacitateAggroMod \( 500 \) Aggro:MovementImpairAggroMod \( 175 \) Changed Spells:SpellAggroModifier to Aggro:SpellAggroMod \( 100 \) Changed Spells:BardSpellAggroMod to Aggro:SongAggroMod \( 33 \) Changed Spells:PetSpellAggroMod to Aggro:PetSpellAggroMod \( 10 \)

## 01/16/2008

* **KLS** Updated AA\_Data.sql with various small fixes.
* **KLS** Changed HasPet\(\) to check for the existance of the pet as mob as well as the petid, should sync up with GetPet\(\) nicely now.

## 01/15/2008

* **KLS** LDoN /open will only check for class now, client does not enforce bodytype so neither will the server.
* **KLS** Numhits in disciplines should work correctly now
* **KLS** Changed many instances where HasPet\(\) was being checked to verify that we have a valid pet pointer from GetPet\(\), GetPet\(\) will be used instead, \(it is possible to have a valid pet ID and an invalid GetPet\(\) pointer\)
* **KLS** Bind wound will no longer check for existance of skill, everyone gets this skill and it was breaking bind wound for people with 0 skill.
* **KLS** Fixed an issue that was keeping berserkers and rangers from triple attacking.
* **KLS** PickPocket should now correctly skill up on it's own through normal use.
* **KLS** GetMinLevel\(int16 spell\_id\) will now return 0 if the level for the class was 255 instead of 255, many buff formulas do not work well with 255 which can cause some issues when a class can use a clicky item with a spell they cannot scribe normally.
* **KLS** GetProcID\(\) should no longer have hard coded values.. whatever these represented are no longer valid in the current spell data.

## 01/14/2008

* **WildcardX** Replaced the corpse consent system with one that allows cross zone player consents.

## 01/13/2008

* **FatherNitwit** \(Derision\) Added tool \(awater\) to extract BSP tree with region type info from .s3d files into .wtr files.
* **FatherNitwit** \(Derision\) Added support for zone to load .wtr files.
* **FatherNitwit** \(Derision\) Employ water file to prevent under water mobs from sinking.
* **FatherNitwit** \(Derision\) Employ water file to enforce fishing near water.

  New Rules \(see ruletypes.h for more info\):

* **Watermap**CheckWaypointsInWaterWhenLoading \(Default: false\)
* **Watermap**CheckForWaterAtWaypoints \(Default: false\)
* **Watermap**CheckForWaterWhenMoving \(Default: false\)
* **Watermap**CheckForWaterOnSendTo \(Default: false\)
* **Watermap**CheckForWaterWhenFishing \(Default: false\)
* **Watermap**FishingRodLength \(Default: 30\)
* **Watermap**FishingLineLength \(Default: 40\)

## 01/12/2008

* **WildcardX** \(cavedude\) Fixed beastlord pet sizes.

## 01/09/2008

* **KLS** Starting items will now be saved if they are placed in slots other than the primary 8, this includes inside bags and on the character's inventory and bank slots
* **KLS** Kick at level 55 or higher now has a chance to act as a spell interrupt as bash does.
* **KLS** \(TheLieka\) Stun Immunity for Frontal Stuns on Ogres
* **KLS** \(TheLieka\) Added out of combat regen to NPCs based on rule NPC:OOCRegen
* **KLS** NPCs with quests using the Perl Quest Parser should no longer stop if they do not have an EVENT\_SAY sub
* **KLS** /autofire cleaned up some, fixed many situations where it shouldn't fire and it now will auto. use throwing weapons as well as bows
* **KLS** Ranged and Throwing attacks will break invis. correctly.
* **KLS** Added the following rules:
  * Character:HealOnLevel \(Default: false\)
  * Character:FeignKillsPet \(Default: false\)
  * Character:ItemManaRegenCap \(Default: 15\)
  * Character:ItemHealthRegenCap \(Default: 15\)
  * Combat:UseIntervalAC \(Default: false\)
  * Combat:PetAttackMagicLevel \(Default: 30\)
  * NPC:SayPauseTimeInSec \(Default: 5\)
  * NPC:OOCRegen \(Default: 0\)

## 01/08/06

* **FatherNitwit** Fixed more windows compile errors on .net 2003+...

